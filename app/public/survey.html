<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Friend Finder Survey</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.js"
        integrity="sha256-BTlTdQO9/fascB1drekrDVkaKd9PkwBymMlHOiG+qLI=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</head>

<body>
    <style>
        body {
            background-color: rgb(46, 45, 45);
        }

        #wrapper {
            width: 1024px;
            margin: 0 auto;
        }

        #wrapper2 {
            margin: 0 auto;
            text-align: center;
        }

        img {
            height: 300px;
            width:200px;
        }

        .jumbotron {
            margin-top: 1%;
            text-align: center;
            background-image: linear-gradient(to bottom, #60a381, #218ed1);
        }

        #links {
            color: white;
        }

        label {
            color: white;
        }

        .btn {
            background-image: linear-gradient(to bottom, #60a381, #218ed1);
            color: black;
        }

        .btn:hover {
            background-image: linear-gradient(to bottom, #407058, #15608f);
        }

        h2 {
            background-image: linear-gradient(to bottom, #60a381, #218ed1);
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            margin-bottom: 1%;
            line-height: 40px;
        }

        .modal-head {
            background-image: linear-gradient(to bottom, #60a381, #218ed1);
            color: black;
            text-align: center !important;
        }

        .modal-title {
            color: black;
        }

        #myModal {
            text-align: center;
        }

    </style>
    <div id="wrapper">
        <div id="myModal" class="modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-head">
                        <h2 class="modal-title">Friend Found!</h2>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary close" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="jumbotron">
            <h1 class="display-4">Friend Finder Survey</h1>
            <hr class="my-4">
            <p>Go on, tell us a bit about your wonderful self!</p>
        </div>
        <form>
            <div class="form-group">
                <h2>Name (Required)</h2>
                <input type="name" class="form-control" id="userName" placeholder="enter your name here">
            </div>
            <div class="form-group">
                <h2>Image Link (Required)</h2>
                <input type="link" class="form-control" id="userPhoto" placeholder="enter your image url here">
            </div>
            <h2>Question: 1</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">On a Saturday night, would you love to be out on the
                    town?</label>
                <select class="form-control" id="score1">
                    <option>1 (No thanks, staying in!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (Let's party!)</option>
                </select>
            </div>
            <h2>Question: 2</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Are books better than movies?</label>
                <select class="form-control" id="score2">
                    <option>1 (Movies all the way!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (Books are always better!)</option>
                </select>
            </div>
            <h2>Question: 3</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Does a walk through an art museum sound like a great way to spend
                    an afternoon?</label>
                <select class="form-control" id="score3">
                    <option>1 (Boring!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (I could spend hours in a museum!)</option>
                </select>
            </div>
            <h2>Question: 4</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Would you rather be in the mountains than in the city?</label>
                <select class="form-control" id="score4">
                    <option>1 (And get mosquito bites? No thank you!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (Any day! I love the great outdoors!)</option>
                </select>
            </div>
            <h2>Question: 5</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Do you enjoy going to concerts?</label>
                <select class="form-control" id="score5">
                    <option>1 (Count me out!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (I live for live music!)</option>
                </select>
            </div>
            <h2>Question: 6</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Are you passionate about your career?</label>
                <select class="form-control" id="score6">
                    <option>1 (Work? Absolutely not!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (Yes! My career is super important to me!)</option>
                </select>
            </div>
            <h2>Question: 7</h2>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Do you believe that steady communication is essential to
                    maintaining a relationship?</label>
                <select class="form-control" id="score7">
                    <option>1 (I'll talk to you at...some point I'm sure!)</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5 (Goodmorning texts are a great way to start the day!)</option>
                </select>
            </div>
        </form>
        <div id="wrapper2">
            <a id="submit" class="btn btn-primary btn-lg" href="" role="button">Find My Friend!</a>
        </div>
        <p id="links">
            <a href="/home">Home</a>
            |
            <a href="../api/friends">API Friend List</a>
            |
            <a href="https://github.com/bryce-senninger/FriendFinder">GitHub Repo</a>
        </p>
    </div>
</body>
<script type="text/javascript">

    function clearVals() {
        $("#userName").val("");
        $("#userPhoto").val("");
        $("#score1").val("");
        $("#score2").val("");
        $("#score3").val("");
        $("#score4").val("");
        $("#score5").val("");
        $("#score6").val("");
        $("#score7").val("");
    }

    window.onload = clearVals();

    let differences = [];
    let currentDifference = [];
    let differenceSum;

    $("#submit").on("click", function (event) {
        event.preventDefault();
        let newFriend = {
            name: $("#userName").val().trim(),
            photo: $("#userPhoto").val().trim(),
            scores: [parseInt($("#score1").val()), parseInt($("#score2").val()), parseInt($("#score3").val()), parseInt($("#score4").val()), parseInt($("#score5").val()), parseInt($("#score6").val()), parseInt($("#score7").val())]
        };
        $.ajax({
            url: "http://localhost:8080/api/friends",
            method: "GET"
        }).then(function (response) {
            for (x = 0; x < response.length; x++) {
                currentDifference = [];
                for (i = 0; i < newFriend.scores.length; i++) {
                    let difference = function (a, b) { return Math.abs(a - b); }
                    currentDifference.push((difference(newFriend.scores[i], response[x].scores[i])));
                }
                differenceSum = currentDifference.reduce((a, b) => a + b);
                differences.push(differenceSum);
            }
            let minDifference = differences.indexOf(Math.min(...differences));
            $(".modal-body").append("<h3>" + response[minDifference].name + "<h3>");
            $(".modal-body").append("<img src=" + response[minDifference].photo + "alt='friendphoto'>");
            $("#myModal").modal('show');
        });
        $.post("/api/friends", newFriend, function (data) {
            clearVals();
        });
    });
</script>

</html>